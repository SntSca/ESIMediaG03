<div class="usuario-header">
  <div class="usuario-info">
    <div class="avatar">{{ userInitials }}</div>
    <div class="datos">
      <div class="nombre">{{ userName }}</div>
      <div class="email">{{ userEmail }}</div>
    </div>
  </div>
  <button class="btn-cerrar" (click)="cerrarSesion()">Cerrar sesiÃ³n</button>
</div>

<div class="filtros">
  <input type="text" [(ngModel)]="filtros.titulo" placeholder="Buscar por tÃ­tulo" (input)="aplicarFiltros()" />
  <select [(ngModel)]="filtros.tipo" (change)="aplicarFiltros()">
    <option value="">Todos los tipos</option>
    <option value="AUDIO">Audio</option>
    <option value="VIDEO">Video</option>
  </select>
  <select [(ngModel)]="filtros.vip" (change)="aplicarFiltros()">
    <option value="">VIP / No VIP</option>
    <option value="si">VIP</option>
    <option value="no">No VIP</option>
  </select>
  <select [(ngModel)]="filtros.visible" (change)="aplicarFiltros()">
    <option value="">Visible / No visible</option>
    <option value="si">Visible</option>
    <option value="no">No visible</option>
  </select>
  <input type="text" [(ngModel)]="filtros.tagIncluye" placeholder="Buscar por tag" (input)="aplicarFiltros()" />
  <select [(ngModel)]="filtros.ordenar" (change)="aplicarFiltros()">
    <option value="fecha">Ordenar por fecha</option>
    <option value="titulo">Ordenar por tÃ­tulo</option>
    <option value="vip">Ordenar por VIP</option>
    <option value="visible">Ordenar por visibilidad</option>
  </select>
</div>

<div class="contenidos">
  <h2>Contenidos disponibles</h2>
  <div *ngIf="loading">Cargando contenidos...</div>
  <div *ngIf="errorMsg" class="error">{{ errorMsg }}</div>

  <div *ngIf="contenidosFiltrados.length === 0 && !loading">No hay contenidos disponibles</div>

  <ul>
    <li *ngFor="let contenido of contenidosFiltrados">
      <div class="contenido-item">
        <div class="titulo">
          {{ contenido.titulo }} 
          <span *ngIf="contenido.vip" class="vip">VIP</span>
          <span *ngIf="contenido.tipo === 'AUDIO'">ðŸŽµ</span>
          <span *ngIf="contenido.tipo === 'VIDEO'">ðŸŽ¬</span>
        </div>
        <div class="descripcion">{{ contenido.descripcion }}</div>
        <div class="tags">Tags: {{ contenido.tags.join(', ') }}</div>
        <div class="acciones">
          <button (click)="toggleFavorito(contenido)">
            {{ contenido.favorito ? 'ðŸ’– Favorito' : 'â™¡ AÃ±adir a favoritos' }}
          </button>
          <button (click)="marcarVisto(contenido)" [disabled]="contenido.visto">
            {{ contenido.visto ? 'âœ… Visto' : 'Marcar como visto' }}
          </button>
        </div>
      </div>
    </li>
  </ul>
</div>

<div class="favoritos">
  <h2>Favoritos</h2>
  <ul>
    <li *ngFor="let fav of favoritos">
      {{ fav.titulo }} <span *ngIf="fav.vip" class="vip">VIP</span>
    </li>
  </ul>
  <div *ngIf="favoritos.length === 0">No tienes contenidos favoritos.</div>
</div>

<div class="historial">
  <h2>Historial</h2>
  <ul>
    <li *ngFor="let h of historial">
      {{ h.titulo }} <span *ngIf="h.vip" class="vip">VIP</span>
    </li>
  </ul>
  <div *ngIf="historial.length === 0">No has visto ningÃºn contenido aÃºn.</div>
</div>
