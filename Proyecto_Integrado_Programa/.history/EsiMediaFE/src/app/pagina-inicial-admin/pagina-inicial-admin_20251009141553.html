<div class="full-screen-wrapper">
  <div class="page-wrapper">
    <!-- Barra superior -->
    <nav class="navbar">
      <ul class="navbar-options">
        <li><a routerLink="/inicio">Inicio</a></li>
        <li><a routerLink="/usuarios" class="active">Usuarios</a></li>
        <li><a routerLink="/configuracion">Configuración</a></li>
        <li><a routerLink="/ayuda">Ayuda</a></li>
      </ul>

      <div class="user-panel">
        <div class="user-photo">{{ userInitials }}</div>
        <div class="user-info">
          <div class="user-name">{{ userName }}</div>
          <div class="user-email">{{ userEmail }}</div>
          <div class="user-role">{{ userRole }}</div>
        </div>
        <button class="logout-btn" (click)="cerrarSesion()">Cerrar Sesión</button>
      </div>
    </nav>

    <div class="main-container">
      <!-- Panel lateral -->
      <aside class="filter-panel">
        <h3>Filtros</h3>
        <form #filtrosForm="ngForm" (ngSubmit)="aplicarFiltros(filtrosForm)">
          <div class="filter-section">
            <label for="fecha">Por Fecha:</label>
            <input id="fecha" type="date" name="fecha" [(ngModel)]="filtros.fecha">
          </div>

          <div class="filter-section">
            <label for="nombre">Por Nombre:</label>
            <input id="nombre" type="text" name="nombre" [(ngModel)]="filtros.nombre" placeholder="Buscar nombre...">
          </div>

          <div class="filter-section">
            <label for="tema">Por Tema:</label>
            <select id="tema" name="tema" [(ngModel)]="filtros.tema">
              <option value="">Todos</option>
              <option value="tecnologia">Tecnología</option>
              <option value="educacion">Educación</option>
              <option value="salud">Salud</option>
            </select>
          </div>

          <div class="filter-section">
            <label for="bloqueado">Por Bloqueado:</label>
            <select id="bloqueado" name="bloqueado" [(ngModel)]="filtros.bloqueado">
              <option value="">Todos</option>
              <option value="si">Sí</option>
              <option value="no">No</option>
            </select>
          </div>

          <div class="filter-section">
            <label for="ordenar">Ordenar por:</label>
            <select id="ordenar" name="ordenar" [(ngModel)]="filtros.ordenar">
              <option value="fecha">Fecha</option>
              <option value="nombre">Nombre</option>
              <option value="tema">Tema</option>
              <option value="bloqueado">Bloqueado</option>
            </select>
          </div>

          <button type="submit" class="filter-btn">Aplicar Filtros</button>
        </form>
      </aside>

      <!-- Tabla de usuarios -->
      <main class="content-area">
        <table class="users-table" *ngIf="usuariosMostrar.length > 0; else noUsers">
          <thead>
            <tr>
              <th>Foto</th>
              <th>Nombre</th>
              <th>Email</th>
              <th>Rol</th>
              <th>Tema</th>
              <th>Bloqueado</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let u of usuariosMostrar">
              <td><div class="user-photo-small">{{ u.iniciales }}</div></td>
              <td>{{ u.nombre }}</td>
              <td>{{ u.email }}</td>
              <td>{{ u.rol }}</td>
              <td>{{ u.tema }}</td>
              <td>{{ u.bloqueado ? 'Sí' : 'No' }}</td>
              <td class="actions-cell">
                <button class="action-btn btn-edit" (click)="editar(u)">Editar</button>
                <button class="action-btn btn-block" (click)="bloquear(u)">
                  {{ u.bloqueado ? 'Desbloquear' : 'Bloquear' }}
                </button>
                <button class="action-btn btn-consult" (click)="consultar(u)">Consultar</button>
              </td>
            </tr>
          </tbody>
        </table>

        <ng-template #noUsers>
          <p class="no-data">No hay usuarios que coincidan con los filtros.</p>
        </ng-template>
      </main>
    </div>

    <!-- Modal -->
    <div class="modal" *ngIf="modalAbierto">
      <div class="modal-content">
        <span class="close" (click)="cerrarModal()">&times;</span>
        <div class="modal-user-photo">{{ usuarioSeleccionado?.iniciales }}</div>
        <div class="modal-user-info">
          <p><strong>Nombre:</strong> {{ usuarioSeleccionado?.nombre }}</p>
          <p><strong>Email:</strong> {{ usuarioSeleccionado?.email }}</p>
          <p><strong>Rol:</strong> {{ usuarioSeleccionado?.rol }}</p>
          <p><strong>Tema:</strong> {{ usuarioSeleccionado?.tema }}</p>
          <p><strong>Bloqueado:</strong> {{ usuarioSeleccionado?.bloqueado ? 'Sí' : 'No' }}</p>
        </div>
        <div class="modal-actions">
          <button class="action-btn btn-edit" (click)="editar(usuarioSeleccionado)">Editar</button>
          <button class="action-btn btn-block" (click)="usuarioSeleccionado && bloquear(usuarioSeleccionado)">
            {{ usuarioSeleccionado?.bloqueado ? 'Desbloquear' : 'Bloquear' }}
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
